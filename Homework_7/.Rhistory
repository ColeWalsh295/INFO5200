library(tidyverse)
vid = readRDS("info5200.7.rds")
vid$event_type
unique(vid$event_type)
#######################################
####### BEGIN INPUT: Question 1 #######
#######################################
unique(vid$event_type)
table(vid$event_type)
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 1 #######
#######################################
table(vid$event_type)
#######################################
#######################################
unique(vid$id)
length(unique(vid$id))
#######################################
####### BEGIN INPUT: Question 2 #######
#######################################
length(unique(vid$id))
vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = mean(N.Events))
#######################################
#######################################
vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = mean(N.Events)) %>%
pop()
vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = mean(N.Events)) %>%
pull()
#######################################
####### BEGIN INPUT: Question 2 #######
#######################################
length(unique(vid$id))
vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = mean(N.Events)) %>%
pull()
#######################################
#######################################
paste(length(unique(vid$id)), 'users watched the video', sep = ' ')
#######################################
####### BEGIN INPUT: Question 2 #######
#######################################
paste(length(unique(vid$id)), 'users watched the video', sep = ' ')
paste('Users have', vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = mean(N.Events)) %>%
pull(), 'video events, on average', sep = ' ')
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 2 #######
#######################################
paste(length(unique(vid$id)), 'users watched the video', sep = ' ')
paste('Users have', vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = round(mean(N.Events)), 1) %>%
pull(), 'video events, on average', sep = ' ')
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 2 #######
#######################################
paste(length(unique(vid$id)), 'users watched the video', sep = ' ')
paste('Users have', vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = round(mean(N.Events), 1)) %>%
pull(), 'video events, on average', sep = ' ')
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 3 #######
#######################################
hist(ifelse(is.na(vid$video_current_time), vid$video_old_time, vid$video_current_time), breaks = 300)
#######################################
#######################################
head(vid)
head(vid$pause_video)
head(vid[vid$event_type == 'pause_video', ])
library(plyr)
sapply(vid[vid$event_type == 'pause_video', ], function (x) round_any(x, 10))
head(vid[vid$event_type == 'pause_video', ])
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10))
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
arrange(desc(.))
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10))
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
group_by(video_current_time) %>%
summarize(n())
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
data.frame(.)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
data.frame(.) %>%
group_by(video_current_time) %>%
summarize(n())
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
data.frame(.) %>%
group_by(video_current_time)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
data.frame(.) %>%
group_by(video_current_time) %>%
summarize(n())
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
data.frame(.) %>%
group_by(video_current_time) %>%
summarize(n(.))
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
data.frame(.) %>%
group_by(video_current_time)
sapply(vid[vid$event_type == 'pause_video', c('id', 'video_current_time')], function (x) round_any(x[, 'video_current_time'], 10)) %>%
data.frame(.)
sapply(vid[vid$event_type == 'pause_video', c('id', 'video_current_time')], function (x) round_any(x[, c('video_current_time')], 10)) %>%
data.frame(.)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq))
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames <- `(c("Time Paused", "dFrequency"))
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Paused", "dFrequency"))
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Paused", "Frequency"))
head(vid)
head(vid[vid$event_type == 'seek_video',])
vid[vid$event_type == 'seek_video',]
library(tidyverse)
vid = readRDS("info5200.7.rds")
#######################################
####### BEGIN INPUT: Question 1 #######
#######################################
table(vid$event_type)
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 2 #######
#######################################
paste(length(unique(vid$id)), 'users watched the video', sep = ' ')
paste('Users have', vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = round(mean(N.Events), 1)) %>%
pull(), 'video events, on average', sep = ' ')
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 3 #######
#######################################
hist(ifelse(is.na(vid$video_current_time), vid$video_old_time, vid$video_current_time), breaks = 300)
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 4 #######
#######################################
library(plyr)
sapply(vid[vid$event_type == 'pause_video', 'video_current_time'], function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Paused", "Frequency"))
#######################################
#######################################
vid[vid$event_type == 'seek_video',]
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time) %>%
sapply(., function (x) round_any(x, 10))) %>%
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Paused", "Frequency"))
vid %>%
filter((event_type == 'seek_video') & (video_new_time > video_old_time)) %>%
select(video_old_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Seek Forwards", "Frequency"))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Seek Backwards", "Frequency"))
#######################################
####### BEGIN INPUT: Question 5 #######
#######################################
vid %>%
filter((event_type == 'seek_video') & (video_new_time > video_old_time)) %>%
select(video_old_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Seek Forwards", "Frequency"))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
`colnames<-`(c("Time Seek Backwards", "Frequency"))
#######################################
#######################################
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3) %>%
`colnames<-`(c("Time Paused", "Frequency"))
#######################################
####### BEGIN INPUT: Question 5 #######
#######################################
vid %>%
filter((event_type == 'seek_video') & (video_new_time > video_old_time)) %>%
select(video_old_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3) %>%
`colnames<-`(c("Time Seek Forwards", "Frequency"))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3) %>%
`colnames<-`(c("Time Seek Backwards", "Frequency"))
#######################################
#######################################
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
mutate(video_old_time = sapply(. %>% select(video_old_time), function (x) round_any(x, 10)),
video_newtime = sapply(. %>% select(video_new_time), function(x) round_any(x, 10)))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
mutate(video_old_time = sapply(. %>% select(video_old_time), function (x) round_any(x, 10)))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time)
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
mutate(video_old_time = sapply(. %>% select(video_old_time), function (x) round_any(x, 10)),
video_newtime = sapply(. %>% select(video_new_time), function(x) round_any(x, 10)))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10)) %>%
data.frame(.)
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10)) %>%
data.frame(.) %>%
mutate(Time_pairs = paste(video_old_time, video_new_time, sep = ','))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10)) %>%
data.frame(.) %>%
mutate(Time.Pairs = paste(video_old_time, video_new_time, sep = ',')) %>%
select(Time.Pairs) %>%
table(.) %>%
data.frame(.)
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10)) %>%
data.frame(.) %>%
mutate(Time.Pairs = paste(video_old_time, video_new_time, sep = ',')) %>%
select(Time.Pairs) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq))
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10)) %>%
data.frame(.) %>%
mutate(Time.Pairs = paste(video_old_time, video_new_time, sep = ',')) %>%
select(Time.Pairs) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3)
#######################################
####### BEGIN INPUT: Question 6 #######
#######################################
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10)) %>%
data.frame(.) %>%
mutate(Time.Pairs = paste(video_old_time, video_new_time, sep = ',')) %>%
select(Time.Pairs) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3) %>%
`colnames<-`(c("Pairs of From-To Seeks", "Frequency"))
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 6 #######
#######################################
vid %>%
filter((event_type == 'seek_video') & (video_new_time < video_old_time)) %>%
select(video_old_time, video_new_time) %>%
lapply(., function(x) round_any(x, 10)) %>%
data.frame(.) %>%
mutate(Time.Pairs = paste(video_old_time, video_new_time, sep = ',')) %>%
select(Time.Pairs) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3) %>%
`colnames<-`(c("Pairs of From-To Backward Seeks", "Frequency"))
#######################################
#######################################
vid
vid %>%
filter(!is.na(video_new_speed))
vid %>%
filter(!is.na(video_old_speed))
vid %>%
filter(!is.na(video_new_speed))
vid %>%
filter(!is.na(video_new_speed)) %>%
mutate(Speed.Up = video_new_speed > video_old_speed)
vid %>%
filter(!is.na(video_new_speed)) %>%
mutate(Speed.Up = video_new_speed > video_old_speed) %>%
summarize(mean(Speed.Up))
vid %>%
filter(!is.na(video_new_speed)) %>%
mutate(Speed.Up = video_new_speed > video_old_speed) %>%
summarize(mean(Speed.Up)) %>%
pull()
vid %>%
filter(!is.na(video_new_speed)) %>%
mutate(Speed.Up = video_new_speed > video_old_speed) %>%
summarize(round(mean(Speed.Up), 1)) %>%
pull()
vid %>%
filter(!is.na(video_new_speed)) %>%
mutate(Speed.Up = video_new_speed > video_old_speed) %>%
summarize(round(mean(Speed.Up), 3)) %>%
pull()
paste(vid %>%
filter(!is.na(video_new_speed)) %>%
mutate(Speed.Up = video_new_speed > video_old_speed) %>%
summarize(round(mean(Speed.Up), 3)) %>%
pull(), 'of all speed changes are speed-ups.', sep = ' ')
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time)
library(tidyverse)
vid = readRDS("info5200.7.rds")
#######################################
####### BEGIN INPUT: Question 1 #######
#######################################
table(vid$event_type)
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 2 #######
#######################################
paste(length(unique(vid$id)), 'users watched the video', sep = ' ')
paste('Users have', vid %>%
group_by(id) %>%
summarize(N.Events = n()) %>%
summarize(Avg.Events = round(mean(N.Events), 1)) %>%
pull(), 'video events, on average', sep = ' ')
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 3 #######
#######################################
hist(ifelse(is.na(vid$video_current_time), vid$video_old_time, vid$video_current_time), breaks = 300)
#######################################
#######################################
#######################################
####### BEGIN INPUT: Question 4 #######
#######################################
library(plyr)
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3) %>%
`colnames<-`(c("Time Paused", "Frequency"))
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time)
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time) %>%
sapply(., function (x) round_any(x, 10))
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time)
vid %>%
filter(event_type == 'pause_video')
vid %>%
filter(event_type == 'pause_video') %>%
select(video_current_time)
vid %>%
ungroup() %>%
filter(event_type == 'pause_video') %>%
select(video_current_time)
#######################################
####### BEGIN INPUT: Question 4 #######
#######################################
library(plyr)
vid %>%
ungroup() %>%
filter(event_type == 'pause_video') %>%
select(video_current_time) %>%
sapply(., function (x) round_any(x, 10)) %>%
table(.) %>%
data.frame(.) %>%
arrange(desc(Freq)) %>%
top_n(., 3) %>%
`colnames<-`(c("Time Paused", "Frequency"))
#######################################
#######################################
